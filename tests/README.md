# Тесты для HFE криптосистемы

Этот каталог содержит Python-скрипты для тестирования различных аспектов реализации HFE криптосистемы.

## Доступные тесты

### 1. `test_correctness.py`
Проверяет корректность работы шифрования и расшифрования для всех версий (базовая, CPU-параллельная, GPU-параллельная).

**Использование:**
```bash
python3 tests/test_correctness.py
# или
./tests/test_correctness.py
```

**Что проверяется:**
- Корректность шифрования/расшифрования различных типов данных
- Работа с пустыми данными
- Работа с большими объемами данных
- Соответствие исходных и расшифрованных данных
- Тестирование всех доступных версий (base, CPU, GPU)

### 2. `test_base.py`
Тестирует базовую версию HFE (без распараллеливания).

**Использование:**
```bash
python3 tests/test_base.py
# или
./tests/test_base.py
```

**Параметры:**
- Размер данных: 2048 байт
- Уровень логирования: INFO

### 3. `test_cpu.py`
Тестирует CPU-параллельную версию HFE.

**Использование:**
```bash
python3 tests/test_cpu.py
# или
./tests/test_cpu.py
```

**Параметры:**
- Размер данных: 2048 байт
- Количество процессов: 4
- Уровень логирования: INFO

### 4. `test_gpu.py`
Тестирует GPU-параллельную версию HFE (если CUDA доступен).

**Использование:**
```bash
python3 tests/test_gpu.py
# или
./tests/test_gpu.py
```

**Параметры:**
- Размер данных: 65536 байт
- Уровень логирования: INFO

**Примечание:** Если CUDA недоступен, тест будет пропущен с предупреждением.

### 5. `test_all.py`
Комплексный тест всех версий HFE с сравнением производительности.

**Использование:**
```bash
python3 tests/test_all.py
# или
./tests/test_all.py
```

**Параметры:**
- Размер данных: 16000 байт
- Режим: все версии (base, cpu, gpu)
- Логи сохраняются в `logs/test_all.log`

### 6. `test_performance.py`
Тест производительности всех версий с разными размерами данных.

**Использование:**
```bash
python3 tests/test_performance.py
# или
./tests/test_performance.py
```

**Что делает:**
- Тестирует с размерами данных: 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536 байт
- Сохраняет результаты в `logs/performance_results.log`
- Позволяет сравнить производительность разных версий

### 7. `run_all_tests.py`
Запускает все тесты последовательно и выводит итоговую статистику.

**Использование:**
```bash
python3 tests/run_all_tests.py
# или
./tests/run_all_tests.py
```

**Что делает:**
- Запускает все доступные тесты
- Выводит цветную статистику (зеленый = пройден, красный = провален, желтый = пропущен)
- Возвращает код выхода 0 при успехе, 1 при наличии провалов

## Быстрый старт

### Запуск всех тестов:
```bash
cd /path/to/hw
python3 tests/run_all_tests.py
# или
./tests/run_all_tests.py
```

### Запуск конкретного теста:
```bash
python3 tests/test_correctness.py
python3 tests/test_base.py
python3 tests/test_cpu.py
python3 tests/test_gpu.py
python3 tests/test_all.py
python3 tests/test_performance.py
```

## Требования

- Python 3.7+
- Установленные зависимости из `requirements.txt`

Для GPU-тестов дополнительно требуется:
- NVIDIA GPU с поддержкой CUDA
- PyTorch с поддержкой CUDA (`torch` с CUDA)

## Структура выходных данных

Тесты создают следующие файлы (если применимо):

- `logs/test_all.log` - логи комплексного теста
- `logs/performance_results.log` - результаты тестирования производительности

## Примеры вывода

### Успешный тест:
```
==================================================
Тест базовой версии HFE
==================================================
Запуск базовой версии с размером данных 2048 байт...
...

✓ Тест базовой версии пройден успешно
```

### Проваленный тест:
```
==================================================
Тест базовой версии HFE
==================================================
...

✗ Тест базовой версии провален
```

### Пропущенный тест (GPU):
```
==================================================
Тест GPU-параллельной версии HFE
==================================================
Проверка доступности CUDA...
ПРЕДУПРЕЖДЕНИЕ: CUDA недоступен, тест будет пропущен
Для использования GPU-версии установите PyTorch с поддержкой CUDA
```

## Устранение неполадок

### Тесты не запускаются
- Убедитесь, что скрипты имеют права на выполнение: `chmod +x tests/*.py`
- Проверьте, что вы находитесь в корневой директории проекта
- Убедитесь, что используется правильная версия Python: `python3 --version`

### Ошибки импорта
- Убедитесь, что установлены все зависимости: `pip install -r requirements.txt`
- Проверьте, что Python может найти модули из `src/`
- Убедитесь, что вы запускаете тесты из корневой директории проекта

### GPU тесты не работают
- Это нормально, если CUDA недоступен
- Для использования GPU установите PyTorch с поддержкой CUDA: `pip install torch`
- Убедитесь, что у вас есть NVIDIA GPU с поддержкой CUDA
- Проверьте доступность CUDA: `python3 -c "import torch; print(torch.cuda.is_available())"`

## Интеграция с CI/CD

Тесты можно использовать в системах непрерывной интеграции:

```yaml
# Пример для GitHub Actions
- name: Run tests
  run: |
    pip install -r requirements.txt
    python3 tests/run_all_tests.py
```

## Миграция с bash-скриптов

Если вы использовали старые bash-скрипты (`.sh`), они все еще доступны, но рекомендуется использовать новые Python-скрипты:

- `test_correctness.sh` → `test_correctness.py`
- `test_base.sh` → `test_base.py`
- `test_cpu.sh` → `test_cpu.py`
- `test_gpu.sh` → `test_gpu.py`
- `test_all.sh` → `test_all.py`
- `test_performance.sh` → `test_performance.py`
- `run_all_tests.sh` → `run_all_tests.py`

Преимущества Python-версий:
- Кроссплатформенность (работают на Windows, Linux, macOS)
- Лучшая обработка ошибок
- Более читаемый код
- Легче расширять и модифицировать
